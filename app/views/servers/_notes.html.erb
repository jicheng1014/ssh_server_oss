<%= turbo_frame_tag dom_id(server, :notes) do %>
  <div class="bg-white rounded-lg shadow p-6 mb-6" data-controller="notes" data-notes-server-id-value="<%= server.id %>">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-lg font-semibold text-gray-800">备注</h2>
      <button
        type="button"
        data-action="click->notes#toggleEdit"
        class="text-blue-500 hover:text-blue-700 text-sm font-medium"
        data-notes-target="toggleButton"
      >
        编辑
      </button>
    </div>
    
    <div data-notes-target="displayArea">
      <% if server.notes.present? %>
        <div class="prose max-w-none">
          <%= server.notes %>
        </div>
      <% else %>
        <p class="text-gray-400 text-sm">暂无备注，点击"编辑"添加备注</p>
      <% end %>
    </div>

    <div data-notes-target="editArea" class="hidden">
      <%= form_with model: server, url: server_path(server), method: :patch, data: { turbo_frame: dom_id(server, :notes) } do |form| %>
        <div class="mb-4">
          <%= form.rich_text_area :notes, class: "w-full min-h-[200px]" %>
        </div>
        <div class="flex justify-end space-x-3">
          <button
            type="button"
            data-action="click->notes#cancelEdit"
            class="px-4 py-2 text-gray-700 hover:text-gray-900 border border-gray-300 rounded"
          >
            取消
          </button>
          <%= form.submit "保存", class: "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded cursor-pointer" %>
        </div>
      <% end %>
    </div>
  </div>
<% end %>
